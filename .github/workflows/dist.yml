name: auto-dist
on:
  push:
    branches:
      - '**'
      - '!main'
jobs:
  auto-dist:
    runs-on: ubuntu-latest
    steps:
      - name: clone
        run: |
          git clone https://${{secrets.ACTIONTOKEN}}@github.com/zsummer/zbase.git zbase-master
          git clone https://${{secrets.ACTIONTOKEN}}@github.com/zsummer/zbase.git -b dist zbase-dist
          ls
          cd zbase-master
          git status
          cd ../zbase-dist
          git status
      - name: auto-dist
        run: |
          ls
          cd zbase-master
          bash release_version.sh 
          git status
          cp dist/* ../zbase-dist/
          cd ../zbase-dist/
          git status
          git config --global user.email "yawei.zhang@foxmail.com"
          git config --global user.name "zsummer"
          git add *
          git diff --cached |wc -l
          git commit -a --allow-empty -m "auto dist"  
          git push 
          
          
          
          
